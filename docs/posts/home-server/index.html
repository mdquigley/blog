<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Home Server | Mike Quigley</title>
  <meta name="description" content="Journal for projects, etc.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Home Server" />
<meta property="og:description" content="I&rsquo;ve kept a home server in various configurations over the last several years. Back in April, with an abundance of time at home due to the pandemic, I migrated my server from a old Dell tower running Ubuntu Server to a Raspberry Pi 4 that I had bought a while back and let sit on the shelf. That was fun to tool around with Raspbian and set it up for local network backups and media streaming." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://quig.info/blog/posts/home-server/" />
<meta property="article:published_time" content="2020-12-18T17:45:30-05:00" />
<meta property="article:modified_time" content="2020-12-18T17:45:30-05:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Home Server"/>
<meta name="twitter:description" content="I&rsquo;ve kept a home server in various configurations over the last several years. Back in April, with an abundance of time at home due to the pandemic, I migrated my server from a old Dell tower running Ubuntu Server to a Raspberry Pi 4 that I had bought a while back and let sit on the shelf. That was fun to tool around with Raspbian and set it up for local network backups and media streaming."/>

  
  
  
  <link rel="stylesheet" href="https://quig.info/blog/css/style-white.css">
  
   <link rel="stylesheet" href="https://quig.info/blog/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://quig.info/blog/images/favicon.ico" />

  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/blog/">Blog</a></li>
         
        <li><a href="https://quig.info">Back to quig.info</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://quig.info/blog/posts/welcome-to-blog/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&text=Home%20Server">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&is_video=false&description=Home%20Server">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Home%20Server&body=Check out this article: https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&name=Home%20Server&description=I%26rsquo%3bve%20kept%20a%20home%20server%20in%20various%20configurations%20over%20the%20last%20several%20years.%20Back%20in%20April%2c%20with%20an%20abundance%20of%20time%20at%20home%20due%20to%20the%20pandemic%2c%20I%20migrated%20my%20server%20from%20a%20old%20Dell%20tower%20running%20Ubuntu%20Server%20to%20a%20Raspberry%20Pi%204%20that%20I%20had%20bought%20a%20while%20back%20and%20let%20sit%20on%20the%20shelf.%20That%20was%20fun%20to%20tool%20around%20with%20Raspbian%20and%20set%20it%20up%20for%20local%20network%20backups%20and%20media%20streaming.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&t=Home%20Server">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#hardware-setup">HARDWARE SETUP</a></li>
        <li><a href="#ssh">SSH</a></li>
        <li><a href="#vnc">VNC</a></li>
        <li><a href="#sabnzbd">SABNZBD</a></li>
        <li><a href="#plex-media-server">PLEX MEDIA SERVER</a></li>
        <li><a href="#cron">CRON</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Home Server
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2020-12-18 17:45:30 -0500 EST" itemprop="datePublished">2020-12-18</time>
          
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/blog/tags/ssh" rel="tag">ssh</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/vnc" rel="tag">vnc</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/plex" rel="tag">plex</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/sabnzbd" rel="tag">sabnzbd</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/cron" rel="tag">cron</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/backups" rel="tag">backups </a>
            
             ,  
            <a class="tag-link" href="/blog/tags/server" rel="tag">server</a>
            
             ,  
            <a class="tag-link" href="/blog/tags/scripts" rel="tag">scripts</a>
            
        </div>
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <p>I&rsquo;ve kept a home server in various configurations over the last several years. Back in April, with an abundance of time at home due to the pandemic, I migrated my server from a old Dell tower running Ubuntu Server to a Raspberry Pi 4 that I had bought a while back and let sit on the shelf. That was fun to tool around with Raspbian and set it up for local network backups and media streaming. But recently it appears that the RPi SD card has gone read-only. I tried repairing it but nothing seems to work and I had thought about swapping to an alternate setup so I could experiment with the RPi for other projects anyway. So rather than flash the SD card and try to rebuild my server config (if the card isn&rsquo;t essentially dead), I&rsquo;m going to swap my server setup to an old Mac Mini I have collecting dust. I had previously installed Ubuntu on it in order to format drives and get the RPi server setup anyway, so the big portion is already done.</p>
<p>I&rsquo;ll need it to have <strong>ssh</strong> and <strong>vnc</strong>, as it will sit headless next to my router, as well as <strong>sabnzbd</strong> for newsgroups and <strong>plexmediaserver</strong> for local streaming. It will have two external 4TB hdd&rsquo;s for media storage and local backups of my other computers, and I&rsquo;ll also need <strong>cron</strong> jobs to backup the one 4TB hdd to the other, and to move downloaded .nzb files to the watched folder for plex. I think that&rsquo;s it? I&rsquo;ll edit this if I remember anything else. Super simple compared to what some other folks do with their home servers. I&rsquo;d like to get more use out of it eventually, maybe consolidating music storage to stream within the house.</p>
<h3 id="hardware-setup">HARDWARE SETUP</h3>
<p>Mac Mini (running Ubuntu)<br>
4TB external drive, which Ubuntu mounts at <code>/media/USERNAME/storage</code><br>
4TB external drive, which Ubuntu mounts at <code>/media/USERNAME/bu-storage</code></p>
<h3 id="ssh">SSH</h3>
<p>To install <strong>ssh</strong>: <code>sudo apt install openssh-server</code><br>
To open port 22 on the firewall: <code>sudo ufw allow ssh</code><br>
You can verify the status with: <code>systemctl status ssh</code><br>
and start, stop, or restart it with <code>systemctl start/stop/restart ssh</code><br>
(<a href="https://linuxconfig.org/ubuntu-20-04-ssh-server">Source</a>)</p>
<p>To copy a local machine&rsquo;s public key to the server: <code>ssh-copy-id -i ~/.ssh/id_rsa.pub USERNAME@servername.local</code><br>
Test log in with: <code>ssh USERNAME@servername.local</code><br>
(<a href="https://linuxconfig.org/how-to-generate-and-manage-ssh-keys-on-linux">Source</a>)</p>
<h3 id="vnc">VNC</h3>
<p>To install <strong>vnc</strong>: <code>sudo apt install tightvncserver</code><br>
Configure a password: <code>vncpasswd</code><br>
Install <strong>xfce4</strong>: <code>sudo apt install xfce4 xfce4-goodies</code><br>
Create <strong>~/.vnc/xstartup</strong>: <code>nano ~/.vnc/xstartup</code> and enter:</p>
<pre><code>#!/bin/sh
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS
startxfce4 &amp;
</code></pre><p>Make it executable: <code>chmod +x ~/.vnc/xstartup</code><br>
Service can be started or stopped with: <code>sudo service vncserver@1 start/stop</code><br>
To have <strong>vncserver</strong> run on startup, create:<br>
<code>sudo nano /etc/systemd/system/vncserver@.service</code><br>
Fill it as below. Replace &ldquo;USERNAME&rdquo; with the local user:</p>
<pre><code>[Unit]
Description=Systemd VNC server startup script for Ubuntu 20.04
After=syslog.target network.target

[Service]
Type=forking
User=USERNAME
ExecStartPre=-/usr/bin/vncserver -kill :%i &amp;&gt; /dev/null
ExecStart=/usr/bin/vncserver -depth 24 -geometry 1920x1080 :%i
PIDFile=/home/USERNAME/.vnc/%H:%i.pid
ExecStop=/usr/bin/vncserver -kill :%i

[Install]
WantedBy=multi-user.target
</code></pre><p>To have VNC desktop 1 start after reboot: <code>sudo systemctl enable vncserver@1</code><br>
(<a href="https://linuxconfig.org/vnc-server-on-ubuntu-20-04-focal-fossa-linux">Source</a>)</p>
<h3 id="sabnzbd">SABNZBD</h3>
<p>To install <strong>sabnzbd</strong>: <code>sudo apt install sabnzbdplus</code><br>
To start or stop <code>sudo service sabnzbdplus start/stop</code><br>
Create folders:<br>
<code>/media/USERNAME/storage/media/downloads/complete</code><br>
<code>/media/USERNAME/storage/media/downloads/incomplete</code><br>
<code>/media/USERNAME/storage/media/downloads/watched</code><br>
Open <code>http://localhost:8080/sabnzbd</code> to enter provider info and point to <strong>completed</strong>, <strong>incomplete</strong>, and <strong>watched</strong> folders<br>
To run the service on startup, edit <code>/etc/default/sabnzbdplus</code> and set the required <code>USER=</code> to
the local account<br>
(<a href="https://sabnzbd.org/wiki/installation/install-ubuntu-repo">Source</a>)</p>
<h3 id="plex-media-server">PLEX MEDIA SERVER</h3>
<p>Install: <code>sudo apt install plexmediaserver</code><br>
Run <code>sudo chmod o+rx /media/USERNAME</code> so the <strong>plex</strong> user has <a href="https://support.plex.tv/articles/201543057-why-is-some-of-my-content-not-found/">necessary read and execute permissions</a> on the media libraries<br>
In the browser, open <code>http://127.0.0.1:32400/web</code> to configure through the GUI<br>
Add a Library, name it <strong>Movies</strong> and point it to <code>/media/USERNAME/storage/media/movies</code><br>
Add a Library, name it <strong>TV Shows</strong> and point it to <code>/media/USERNAME/storage/media/tv</code><br>
(<a href="https://support.plex.tv/articles/200288586-installation/">Source</a>)</p>
<h3 id="cron">CRON</h3>
<p>Scripts to be run with <strong>cron</strong> live in <code>/home/USERNAME/crontasks</code><br>
Backup external storage drive with <code>backup_storage.sh</code>:</p>
<pre><code>#!/bin/bash  
rsync -avP --delete /media/USERNAME/storage/ /media/USERNAME/bu-storage/ 2&gt; /home/USERNAME/crontasks/logs backup_storage.err
</code></pre><p>Move downloaded .nzb files to the Plex <strong>watched</strong> folder with <code>move_nzb.sh</code>:</p>
<pre><code>#!/bin/bash
mv /home/USERNAME/Downloads/*.nzb* /media/USERNAME/storage/media/downloads/watched/ &gt; /dev/null 2&gt;&amp;1
</code></pre><p>Load these scripts into <strong>cron</strong> with <code>crontab -e</code>:</p>
<pre><code>0 5 * * * /home/USERNAME/crontasks/backup_storage.sh  
0 * * * * /home/USERNAME/crontasks/move_nzb.sh
</code></pre><p>Careful with your <strong>cron</strong> syntax. Check out <a href="https://crontab.guru/">Crontab Guru</a> to verify any new settings.</p>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/blog/">Blog</a></li>
         
          <li><a href="https://quig.info">Back to quig.info</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#hardware-setup">HARDWARE SETUP</a></li>
        <li><a href="#ssh">SSH</a></li>
        <li><a href="#vnc">VNC</a></li>
        <li><a href="#sabnzbd">SABNZBD</a></li>
        <li><a href="#plex-media-server">PLEX MEDIA SERVER</a></li>
        <li><a href="#cron">CRON</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&text=Home%20Server">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&is_video=false&description=Home%20Server">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Home%20Server&body=Check out this article: https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&title=Home%20Server">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&name=Home%20Server&description=I%26rsquo%3bve%20kept%20a%20home%20server%20in%20various%20configurations%20over%20the%20last%20several%20years.%20Back%20in%20April%2c%20with%20an%20abundance%20of%20time%20at%20home%20due%20to%20the%20pandemic%2c%20I%20migrated%20my%20server%20from%20a%20old%20Dell%20tower%20running%20Ubuntu%20Server%20to%20a%20Raspberry%20Pi%204%20that%20I%20had%20bought%20a%20while%20back%20and%20let%20sit%20on%20the%20shelf.%20That%20was%20fun%20to%20tool%20around%20with%20Raspbian%20and%20set%20it%20up%20for%20local%20network%20backups%20and%20media%20streaming.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fquig.info%2fblog%2fposts%2fhome-server%2f&t=Home%20Server">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2020  Mike Quigley 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/blog/">Blog</a></li>
         
        <li><a href="https://quig.info">Back to quig.info</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/blog/lib/font-awesome/css/all.min.css>
<script src=/blog/lib/jquery/jquery.min.js></script>
<script src=/blog/js/main.js></script>



</html>
